with := def(obj, fun)(ret) {
    ret := obj;
    obj <- fun();
};